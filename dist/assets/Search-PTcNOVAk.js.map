{"version":3,"file":"Search-PTcNOVAk.js","sources":["../../src/components/Search.ts"],"sourcesContent":["import { appStore } from '../stores/AppStore'\n\n/**\n * Search component - Find and filter journal entries\n */\n\nexport function renderSearch(): void {\n  const mainContent = document.getElementById('main-content')\n  if (!mainContent) return\n  \n  mainContent.innerHTML = `\n    <div class=\"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8\">\n      <div class=\"mb-6\">\n        <h1 class=\"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4\">Search Entries</h1>\n        \n        <!-- Search Form -->\n        <div class=\"card\">\n          <div class=\"space-y-4\">\n            <div>\n              <label for=\"search-query\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                Search\n              </label>\n              <div class=\"flex\">\n                <div class=\"relative flex-1\">\n                  <input \n                    type=\"text\" \n                    id=\"search-query\" \n                    class=\"input-field pl-10 rounded-r-none\" \n                    placeholder=\"Search your entries...\"\n                  >\n                  <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                    <i class=\"fas fa-search text-gray-400\"></i>\n                  </div>\n                </div>\n                <button id=\"search-button\" class=\"btn-primary rounded-l-none\">\n                  Search\n                </button>\n              </div>\n            </div>\n            \n            <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div>\n                <label for=\"tag-filter\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Tags\n                </label>\n                <select id=\"tag-filter\" class=\"input-field\">\n                  <option value=\"\">All tags</option>\n                  ${getAvailableTags().map(tag => `<option value=\"${tag}\">${tag}</option>`).join('')}\n                </select>\n              </div>\n              \n              <div>\n                <label for=\"date-from\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  From Date\n                </label>\n                <input type=\"date\" id=\"date-from\" class=\"input-field\">\n              </div>\n              \n              <div>\n                <label for=\"date-to\" class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  To Date\n                </label>\n                <input type=\"date\" id=\"date-to\" class=\"input-field\">\n              </div>\n            </div>\n            \n            <div class=\"flex justify-between items-center\">\n              <div class=\"flex items-center space-x-4\">\n                <label class=\"flex items-center\">\n                  <input type=\"checkbox\" id=\"favorites-only\" class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded\">\n                  <span class=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">Favorites only</span>\n                </label>\n              </div>\n              \n              <button id=\"clear-filters\" class=\"btn-ghost\">\n                Clear filters\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Search Results -->\n      <div class=\"space-y-6\">\n        <div class=\"flex justify-between items-center\">\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n            Search Results <span id=\"results-count\" class=\"text-gray-500 dark:text-gray-400\">(3 entries)</span>\n          </h2>\n          \n          <div class=\"flex items-center space-x-2\">\n            <label for=\"sort-by\" class=\"text-sm text-gray-700 dark:text-gray-300\">Sort by:</label>\n            <select id=\"sort-by\" class=\"text-sm border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 rounded\">\n              <option value=\"date-desc\">Newest first</option>\n              <option value=\"date-asc\">Oldest first</option>\n              <option value=\"title\">Title A-Z</option>\n              <option value=\"relevance\">Relevance</option>\n            </select>\n          </div>\n        </div>\n        \n        <!-- Results List -->\n        <div id=\"search-results\" class=\"space-y-4\">\n          ${generateSearchResults({ query: '', tag: '', dateFrom: '', dateTo: '', favoritesOnly: false, sortBy: 'date-desc' })}\n        </div>\n        \n        <!-- Load More -->\n        <div class=\"text-center\">\n          <button id=\"load-more\" class=\"btn-secondary\">\n            Load more results\n          </button>\n        </div>\n      </div>\n    </div>\n  `\n  \n  setupSearch()\n}\n\n/**\n * Get all available tags from entries\n */\nfunction getAvailableTags(): string[] {\n  const state = appStore.getState()\n  const allTags = new Set<string>()\n  \n  state.entries.forEach(entry => {\n    entry.tags.forEach((tag: string) => allTags.add(tag))\n  })\n  \n  return Array.from(allTags).sort()\n}\n\nfunction generateSearchResults(filters: any): string {\n  const state = appStore.getState()\n  let entries = [...state.entries]\n  \n  // Apply filters\n  if (filters.query) {\n    const query = filters.query.toLowerCase()\n    entries = entries.filter(entry => \n      entry.title.toLowerCase().includes(query) ||\n      entry.content.toLowerCase().includes(query) ||\n      entry.tags.some(tag => tag.toLowerCase().includes(query))\n    )\n  }\n  \n  if (filters.tag) {\n    entries = entries.filter(entry => entry.tags.includes(filters.tag))\n  }\n  \n  if (filters.dateFrom) {\n    const fromDate = new Date(filters.dateFrom)\n    entries = entries.filter(entry => new Date(entry.createdAt) >= fromDate)\n  }\n  \n  if (filters.dateTo) {\n    const toDate = new Date(filters.dateTo)\n    toDate.setHours(23, 59, 59, 999) // End of day\n    entries = entries.filter(entry => new Date(entry.createdAt) <= toDate)\n  }\n  \n  if (filters.favoritesOnly) {\n    entries = entries.filter(entry => entry.isFavorite)\n  }\n  \n  // Sort entries\n  switch (filters.sortBy) {\n    case 'date-asc':\n      entries.sort((a, b) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime())\n      break\n    case 'title':\n      entries.sort((a, b) => a.title.localeCompare(b.title))\n      break\n    case 'date-desc':\n    default:\n      entries.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n      break\n  }\n  \n  // Update results count\n  const resultsCount = document.getElementById('results-count')\n  if (resultsCount) {\n    resultsCount.textContent = `(${entries.length} ${entries.length === 1 ? 'entry' : 'entries'})`\n  }\n  \n  if (entries.length === 0) {\n    return `\n      <div class=\"card text-center py-12\">\n        <i class=\"fas fa-search text-4xl text-gray-400 mb-4\"></i>\n        <p class=\"text-xl text-gray-600 dark:text-gray-400 mb-2\">No entries found</p>\n        <p class=\"text-gray-500 dark:text-gray-400\">Try adjusting your search criteria or <a href=\"/write\" class=\"link\">create a new entry</a></p>\n      </div>\n    `\n  }\n  \n  return entries.map(entry => `\n    <div class=\"card hover:shadow-md transition-shadow duration-200 cursor-pointer\" data-entry-id=\"${entry.id}\">\n      <div class=\"flex justify-between items-start mb-3\">\n        <h3 class=\"text-lg font-medium text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-colors\">\n          ${entry.title}\n          ${entry.isFavorite ? '<i class=\"fas fa-star text-yellow-500 ml-2\"></i>' : ''}\n        </h3>\n        <span class=\"text-sm text-gray-500 dark:text-gray-400\">${formatDate(entry.createdAt.toISOString())}</span>\n      </div>\n      \n      <p class=\"text-gray-600 dark:text-gray-300 mb-3 line-clamp-2\">${convertMarkdownToPlainText(entry.content).slice(0, 200)}${entry.content.length > 200 ? '...' : ''}</p>\n      \n      <div class=\"flex justify-between items-center\">\n        <div class=\"flex flex-wrap gap-2\">\n          ${entry.tags.map(tag => `\n            <span class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200\">\n              ${tag}\n            </span>\n          `).join('')}\n        </div>\n        \n        <div class=\"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400\">\n          <span>${entry.wordCount} words</span>\n          <div class=\"flex space-x-2\">\n            <button class=\"hover:text-blue-600 dark:hover:text-blue-400\" title=\"Edit\">\n              <i class=\"fas fa-edit\"></i>\n            </button>\n            <button class=\"hover:text-red-600 dark:hover:text-red-400\" title=\"Delete\">\n              <i class=\"fas fa-trash\"></i>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  `).join('')\n}\n\n/**\n * Convert markdown to plain text for search previews\n */\nfunction convertMarkdownToPlainText(markdown: string): string {\n  return markdown\n    // Remove headers\n    .replace(/^#{1,6}\\s+(.+)$/gm, '$1')\n    // Remove bold and italic\n    .replace(/\\*\\*(.+?)\\*\\*/g, '$1')\n    .replace(/\\*(.+?)\\*/g, '$1')\n    .replace(/__(.+?)__/g, '$1')\n    .replace(/_(.+?)_/g, '$1')\n    // Remove links\n    .replace(/\\[(.+?)\\]\\(.+?\\)/g, '$1')\n    // Remove code blocks and inline code\n    .replace(/```[\\s\\S]*?```/g, '')\n    .replace(/`(.+?)`/g, '$1')\n    // Remove blockquotes\n    .replace(/^>\\s+(.+)$/gm, '$1')\n    // Remove list markers\n    .replace(/^[\\s]*[-*+]\\s+(.+)$/gm, '$1')\n    .replace(/^[\\s]*\\d+\\.\\s+(.+)$/gm, '$1')\n    // Clean up extra whitespace\n    .replace(/\\n\\s*\\n/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim()\n}\n\nfunction formatDate(dateString: string): string {\n  const date = new Date(dateString)\n  return date.toLocaleDateString('en-US', { \n    year: 'numeric', \n    month: 'short', \n    day: 'numeric' \n  })\n}\n\nfunction setupSearch(): void {\n  const searchQuery = document.getElementById('search-query') as HTMLInputElement\n  const searchButton = document.getElementById('search-button') as HTMLButtonElement\n  const tagFilter = document.getElementById('tag-filter') as HTMLSelectElement\n  const dateFrom = document.getElementById('date-from') as HTMLInputElement\n  const dateTo = document.getElementById('date-to') as HTMLInputElement\n  const favoritesOnly = document.getElementById('favorites-only') as HTMLInputElement\n  const sortBy = document.getElementById('sort-by') as HTMLSelectElement\n  \n  // Search functionality\n  function performSearch(): void {\n    const filters = {\n      query: searchQuery.value,\n      tag: tagFilter.value,\n      dateFrom: dateFrom.value,\n      dateTo: dateTo.value,\n      favoritesOnly: favoritesOnly.checked,\n      sortBy: sortBy.value\n    }\n    \n    // Update search results\n    const searchResults = document.getElementById('search-results')\n    if (searchResults) {\n      searchResults.innerHTML = generateSearchResults(filters)\n      \n      // Re-attach event listeners to new results\n      searchResults.querySelectorAll('[data-entry-id]').forEach(entry => {\n        entry.addEventListener('click', (event) => {\n          const target = event.currentTarget as HTMLElement\n          const entryId = target.getAttribute('data-entry-id')\n          if (entryId) {\n            window.dispatchEvent(new CustomEvent('navigate', { \n              detail: { path: `/entry/${entryId}` } \n            }))\n          }\n        })\n      })\n    }\n  }\n  \n  // Event listeners\n  searchQuery?.addEventListener('input', performSearch)\n  searchButton?.addEventListener('click', performSearch)\n  tagFilter?.addEventListener('change', performSearch)\n  dateFrom?.addEventListener('change', performSearch)\n  dateTo?.addEventListener('change', performSearch)\n  favoritesOnly?.addEventListener('change', performSearch)\n  sortBy?.addEventListener('change', performSearch)\n  \n  // Clear filters\n  document.getElementById('clear-filters')?.addEventListener('click', () => {\n    searchQuery.value = ''\n    tagFilter.value = ''\n    dateFrom.value = ''\n    dateTo.value = ''\n    favoritesOnly.checked = false\n    sortBy.value = 'date-desc'\n    performSearch()\n  })\n  \n  // Entry click handlers\n  document.querySelectorAll('[data-entry-id]').forEach(entry => {\n    entry.addEventListener('click', (event) => {\n      const target = event.currentTarget as HTMLElement\n      const entryId = target.getAttribute('data-entry-id')\n      console.log('Clicked entry:', entryId)\n      // TODO: Navigate to entry view\n    })\n  })\n  \n  // Load more\n  document.getElementById('load-more')?.addEventListener('click', () => {\n    console.log('Load more results')\n    // TODO: Implement pagination\n  })\n}\n"],"names":["renderSearch","mainContent","getAvailableTags","tag","generateSearchResults","setupSearch","state","appStore","allTags","entry","filters","entries","query","fromDate","toDate","a","b","resultsCount","formatDate","convertMarkdownToPlainText","markdown","dateString","searchQuery","searchButton","tagFilter","dateFrom","dateTo","favoritesOnly","sortBy","performSearch","searchResults","event","entryId"],"mappings":"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"}